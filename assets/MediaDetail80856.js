import{_ as Z,s as ee,a as te,b as ae,c as oe,d as se,e as le,f as ie,g as ne}from"./index808565.js";import{a as re,b as ce,A as de}from"./LazyDataTable80856.js";import{d as j,r as b,y as A,z as K,o as x,e as G,w as m,A as ue,c as C,a as e,t as v,f as a,u as _,C as me,D as pe,x as Q,E as fe,F as _e,q as z,H as ve,I as xe,n as ge,k,J as be,K as he,v as L,T as we,b as ye}from"../index80856.js";import{u as P}from"./media80856.js";import{s as Ce}from"./index80856.js";import{s as ke}from"./index808563.js";import{s as $e}from"./WarningTable.vue_vue_type_script_setup_true_lang80856.js";import{u as W}from"./settings80856.js";import{a as Se}from"./date80856.js";import"./index808566.js";import"./index808564.js";import"./index808567.js";import"./index808568.js";import"./user80856.js";import"./index808562.js";const Me={key:0,class:"flex flex-col items-center p-8 bg-surface-0 dark:bg-surface-900 rounded-sm"},Ve={class:"font-bold text-2xl block mb-2 mt-6"},De={class:"mb-0"},Te={class:"flex flex-col mb-8 mt-4"},ze={class:"flex items-center gap-2 mt-6"},Be=j({__name:"ChangeStatusVideo",setup(B){const p=P(),f=W(),i=b(),n=A(()=>p.currentMedia);async function t(){var d,s;try{i.value.value?await p.enableMedia(((d=n==null?void 0:n.value)==null?void 0:d.id)+""):await p.disableMedia(((s=n==null?void 0:n.value)==null?void 0:s.id)+""),pe(`Stato video cambiato in ${i.value.label}`)}catch(u){console.error(u)}}return K(n,d=>{d&&(i.value=f.getVideoStatus().find(s=>s.value===d.online))},{immediate:!0}),(d,s)=>{const u=re,r=Q,h=ue;return x(),G(h,{group:"change-status-video"},{container:m(({message:w,acceptCallback:y,rejectCallback:$})=>[n.value?(x(),C("div",Me,[s[2]||(s[2]=e("div",{class:"rounded-full text-primary-contrast inline-flex justify-center items-center"},[e("i",{class:"pi pi-media text-4xl!"})],-1)),e("span",Ve,v(w.header),1),e("p",De,v(w.message),1),e("div",Te,[s[1]||(s[1]=e("label",{for:"notifications_type",class:"text-muted-color font-500 mb-1"},"Cambia stato",-1)),a(u,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=c=>i.value=c),options:_(f).getVideoStatus(),"option-label":"label",class:"w-full md:w-60"},null,8,["modelValue","options"])]),e("div",ze,[a(r,{label:"Annulla",outlined:"",onClick:$,class:"w-32"},null,8,["onClick"]),a(r,{label:"Procedi",onClick:c=>{t(),y()},class:"w-32"},null,8,["onClick"])])])):me("",!0)]),_:1})}}}),Ee={class:"flex items-center gap-2 w-full"},Le={class:"uppercase font-semibold sm:text-xl mb-2 min-h-[24px]"},je={class:"flex justify-end w-full"},Ae={class:"flex items-baseline"},Pe={class:"flex flex-row-reverse sm:flex-col"},Ue={class:"grid grid-cols-none md:grid-cols-[auto_1fr] p-6 pt-0"},Ne={class:"flex items-center flex-col"},Ie={key:1,class:"w-[440px] h-[248px] sm:w-[320px] sm:h-[180px] mb-3 bg-gray-200 flex items-center justify-center"},Re={class:"flex flex-row"},qe={class:"flex flex-col"},Fe={class:"sm:pl-6"},Oe={class:"pt-4 md:pt-0 text-center md:text-left uppercase font-semibold text-xl mb-2 min-h-[24px]"},He={class:"flex flex-wrap justify-between"},Je={class:"flex flex-col sm:flex-row gap-1 sm:gap-7 align-center"},Ke={class:"flex items-center"},Ge={class:"flex gap-4 align-center"},Qe={class:"flex items-center gap-1"},We={class:"flex items-center gap-1"},Xe={class:"flex flex-col sm:flex-row gap-1 sm:gap-7 align-center pt-4"},Ye={class:"flex flex-col"},Ze={class:"flex pt-4"},et={class:"flex flex-col"},tt=j({__name:"MediaDataCard",setup(B){const p=P(),f=W(),i=b(),n=b([{items:[{label:"Cambia stato",command:()=>{$()}},{label:"Scarica video",command:()=>{r()}},{label:"Elimina video",command:()=>{y()}}]}]),t=A(()=>p.currentMedia),d=b(!1),s=b(!1),u=fe();async function r(){var c;if((c=t.value)!=null&&c.download_attachment_url)try{const l=await(await fetch(t.value.download_attachment_url)).blob(),D=window.URL.createObjectURL(l),g=document.createElement("a");g.href=D,g.download=`${t.value.title||"video"}.mp4`,document.body.appendChild(g),g.click(),document.body.removeChild(g),window.URL.revokeObjectURL(D)}catch(o){console.error("Errore durante il download:",o);const l=document.createElement("a");l.href=t.value.download_attachment_url,l.download=`${t.value.title||"video"}.mp4`,l.target="_blank",document.body.appendChild(l),l.click(),document.body.removeChild(l)}}async function h(c){try{await p.deleteMedia(c),await he.push({name:L.media})}catch(o){console.error(o)}}function w(c){d.value=c,c?setTimeout(()=>{s.value=!0},500):s.value=!1}function y(){$e({message:"Stai per eliminare il video. Vuoi confermare l'operazione?",header:"Eliminazione video",acceptCallback(){t.value&&h(t.value.id)}})}function $(){u.require({message:"",header:"Aggiorna stato video",group:"change-status-video",accept:()=>{},reject:()=>{}})}return(c,o)=>{const l=ce,D=Q,g=be,X=ke,Y=Ce,E=we;return x(),C(_e,null,[a(Y,{class:"mt-4",toggleable:"",collapsed:d.value,"onUpdate:collapsed":w},{header:m(()=>{var S,M,V;return[z(e("div",Ee,[e("p",Le,v((S=t.value)==null?void 0:S.title),1)],512),[[ve,d.value&&s.value]]),e("div",je,[e("div",Ae,[z(a(l,{value:_(f).getPrettyVideoStatus((M=t.value)==null?void 0:M.online),severity:_(f).getColorVideoStatus((V=t.value)==null?void 0:V.online),rounded:""},null,8,["value","severity"]),[[E,"Stato",void 0,{top:!0}]]),a(D,{icon:"pi pi-cog",severity:"secondary",rounded:"",text:"",onClick:o[0]||(o[0]=T=>_(xe)(i.value,T))}),a(g,{ref_key:"menu",ref:i,id:"config_menu",model:n.value,popup:""},null,8,["model"])])])]}),default:m(()=>{var S,M,V,T,U,N,I,R,q,F,O,H,J;return[e("div",Pe,[e("div",Ue,[e("div",Ne,[(S=t.value)!=null&&S.attachment_url?(x(),G(_(Z),{key:0,type:"default",previewImageLink:(M=t.value)==null?void 0:M.attachment_img_preview_url,link:(V=t.value)==null?void 0:V.attachment_url,progress:30,isMuted:!1,isControls:!0,class:"w-[440px] h-[248px] sm:w-[320px] sm:h-[180px] mb-3"},null,8,["previewImageLink","link"])):(x(),C("div",Ie,o[1]||(o[1]=[e("i",null,"Errore nel caricamento video",-1)]))),e("div",Re,[e("div",qe,[a(l,{value:_(f).getPrettyVideoCategory(((T=t.value)==null?void 0:T.category)+""),class:ge([_(f).getColorCategory(((U=t.value)==null?void 0:U.category)+""),"flex items-center mr-2 mb-2 flex-1"]),rounded:""},null,8,["value","class"])])])]),e("div",Fe,[e("div",null,[e("h1",Oe,v((N=t.value)==null?void 0:N.title),1)]),e("div",He,[e("div",Je,[e("div",Ke,[a(X,{image:(R=(I=t.value)==null?void 0:I.user)==null?void 0:R.profile_picture_url,class:"mr-2",shape:"circle"},null,8,["image"]),e("span",null,v((F=(q=t.value)==null?void 0:q.user)==null?void 0:F.full_name),1)])]),e("div",Ge,[z((x(),C("div",Qe,[o[2]||(o[2]=e("i",{class:"pi pi-heart-fill text-pink-500 mr-1"},null,-1)),k(" "+v(((O=t.value)==null?void 0:O.likes_counter)||0),1)])),[[E,"Like ricevuti",void 0,{top:!0}]]),z((x(),C("div",We,o[3]||(o[3]=[e("i",{class:"pi pi-eye text-blue-500 mr-1"},null,-1),k(" - ")]))),[[E,"Visualizzazioni",void 0,{top:!0}]])])]),o[6]||(o[6]=e("hr",{class:"mt-2"},null,-1)),e("div",Xe,[e("div",Ye,[o[4]||(o[4]=e("p",{class:"uppercase text-muted-color font-medium mb-4 text-xs"}," data di pubblicazione ",-1)),k(" "+v(_(Se)((H=t.value)==null?void 0:H.created_at)),1)])]),e("div",Ze,[e("div",et,[o[5]||(o[5]=e("p",{class:"uppercase text-muted-color font-medium mb-4 text-xs"}," descrizione ",-1)),k(" "+v(((J=t.value)==null?void 0:J.description)||"-"),1)])])])])])]}),_:1},8,["collapsed"]),a(Be)],64)}}}),xt=j({__name:"MediaDetail",props:{id:{}},setup(B){const p=B,f=P(),i=b([]),n=b(!1),t=A(()=>f.currentMedia);function d(){i.value=[{label:"Tutti i media",route:{name:L.media}}],i.value.push({label:"Dettaglio video",route:{name:L.mediaDettaglio,params:{id:p.id}}})}async function s(u){try{n.value=!0;const r=new Map;await f.fetchMediaDetail(u,r)}catch(r){console.error(r)}finally{n.value=!1}}return K(()=>t.value,u=>{u&&(i.value[i.value.length-1].label=u.title)}),ye(()=>{d(),p.id&&s(p.id)}),(u,r)=>{const h=oe,w=se,y=le,$=ie,c=ne,o=ee;return x(),C("div",null,[a(de,{items:i.value},null,8,["items"]),a(tt),a(o,{class:"mt-4"},{content:m(()=>[a(c,{scrollable:"",value:"0"},{default:m(()=>[a(w,null,{default:m(()=>[a(h,{value:"0"},{default:m(()=>r[0]||(r[0]=[k("Segnalazioni")])),_:1}),a(h,{value:"1"},{default:m(()=>r[1]||(r[1]=[k("Commenti")])),_:1})]),_:1}),a($,null,{default:m(()=>[a(y,{value:"0"},{default:m(()=>{var l;return[a(te,{video_id:(l=t.value)==null?void 0:l.id},null,8,["video_id"])]}),_:1}),a(y,{value:"1"},{default:m(()=>{var l;return[a(ae,{video_id:(l=t.value)==null?void 0:l.id},null,8,["video_id"])]}),_:1})]),_:1})]),_:1})]),_:1})])}}});export{xt as default};

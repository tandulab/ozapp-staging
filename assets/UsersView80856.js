import{u as j,T as p,L as Q,s as q,a as G,b as H,A as J}from"./LazyDataTable80856.js";import{d as C,j as $,r as k,b as D,o as n,e as h,w as s,u as a,k as W,f as t,a as i,l as M,n as S,t as g,c as L,p as X,F as Y,q as Z,v as z,x as ee,T as te}from"../index80856.js";import{s as ae}from"./index808563.js";import{s as oe}from"./index808564.js";import{u as B}from"./user80856.js";import{g as le,p as se,a as re}from"./role80856.js";import{u as ne}from"./settings80856.js";import"./index808562.js";const ie={class:"flex items-center gap-x-2"},ue={class:"flex items-center gap-2"},ce={class:"flex items-center justify-center"},T=10,de=C({__name:"UserTable",setup(K){const u=B(),c=ne(),{users:m,totalUsers:v}=$(u),{onSort:_,onPage:y,onFilter:N,loadLazyData:A,isLoading:E}=j({rows:T},I),w=k({id:{value:"",matchMode:p.EQ},email:{value:"",matchMode:p.LIKE},categories:{value:"",matchMode:p.CONTAINS},role:{value:"",matchMode:p.EQ},full_name:{value:"",matchMode:p.LIKE}});function R(){N(w.value)}async function I(f){try{await u.fetchUsers(f)}catch(r){console.error(r)}}const O=function(f){return{name:z.utentiDettaglio,params:{id:f}}};return D(()=>{A()}),(f,r)=>{const b=oe,x=ee,U=ae,d=q,V=G,F=H,P=te;return n(),h(Q,{value:a(m),rows:T,"total-records":a(v),onSort:a(_),onPage:a(y),onFilter:R,filters:w.value,"onUpdate:filters":r[0]||(r[0]=e=>w.value=e),"data-key":"id",scrollable:"",loading:a(E),showGridlines:"",rowHover:!0},{empty:s(()=>r[1]||(r[1]=[W("Non ci sono utenti")])),default:s(()=>[t(d,{class:"min-w-[200px]","filter-field":"full_name",header:"Utente",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1,"show-clear-button":!1},{filter:s(({filterModel:e,filterCallback:l})=>[i("div",ie,[t(b,{fluid:"",modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,type:"text",placeholder:"Filtra",onKeydown:M(o=>l(),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeydown"]),t(x,{class:S(e.value?"":"invisible"),icon:"pi pi-filter-slash",variant:"text",rounded:"",onClick:o=>{e.value="",l()}},null,8,["class","onClick"])])]),body:s(({data:e})=>[i("div",ue,[e.profile_picture_url?(n(),h(U,{key:0,image:e.profile_picture_url,style:{width:"32px"},shape:"circle"},null,8,["image"])):(n(),h(U,{key:1,label:(e==null?void 0:e.first_name.charAt(0))+(e==null?void 0:e.last_name.charAt(0)),class:"mr-2 text-sm!",size:"width: 32px",shape:"circle"},null,8,["label"])),i("span",null,g(e.full_name),1)])]),_:1}),t(d,{class:"min-w-[200px]",header:"Email",field:"email",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1,"show-clear-button":!0},{filter:s(({filterModel:e,filterCallback:l})=>[t(b,{fluid:"",modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,type:"text",placeholder:"Filtra",onKeydown:M(o=>l(),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:1}),t(d,{class:"min-w-[100px]",header:"Categoria",field:"categories",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1,"show-clear-button":!0},{filter:s(({filterModel:e,filterCallback:l})=>[t(V,{class:"w-full",modelValue:e.value,"onUpdate:modelValue":[o=>e.value=o,l],options:a(c).getUserCategories(),"option-label":"labels.it","option-value":"value"},null,8,["modelValue","onUpdate:modelValue","options"])]),body:s(({data:e})=>[(n(!0),L(Y,null,X(e.categories,(l,o)=>(n(),h(F,{value:a(c).getPrettyCategory(l),class:S([a(c).getColorCategory(l),"flex items-center mr-2 mb-2"]),key:o,rounded:""},null,8,["value","class"]))),128))]),_:1}),t(d,{class:"min-w-[100px]",header:"Ruolo",field:"role",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1,"show-clear-button":!0},{filter:s(({filterModel:e,filterCallback:l})=>[t(V,{class:"w-[100px]",modelValue:e.value,"onUpdate:modelValue":[o=>e.value=o,l],options:a(le)(),"option-label":"label","option-value":"value"},null,8,["modelValue","onUpdate:modelValue","options"])]),body:s(({data:e})=>[t(F,{value:a(se)(e.role),severity:a(re)(e.role)},null,8,["value","severity"])]),_:1}),t(d,{class:"w-[50px]","align-frozen":"right",frozen:""},{body:s(({data:e})=>[i("div",ce,[Z(t(x,{type:"button","aria-haspopup":"true","aria-controls":"overlay_menu",icon:"pi pi-arrow-right",text:"",rounded:"",as:"router-link",to:O(e.id)},null,8,["to"]),[[P,"Dettaglio",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","total-records","onSort","onPage","filters","loading"])}}}),pe={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 mt-2"},me={class:"font-semibold text-2xl mb-4"},xe=C({__name:"UsersView",props:{code:{}},setup(K){const u=k([]),c=B(),{totalUsers:m}=$(c),v=function(){u.value=[{label:"Tutti gli utenti",route:{name:z.utenti}}]};return D(()=>{v()}),(_,y)=>(n(),L("div",null,[t(J,{items:u.value},null,8,["items"]),i("div",pe,[i("div",me,g(a(m))+" "+g(a(m)==1?"Utente":"Utenti"),1)]),t(de,{"is-partner":!!_.code},null,8,["is-partner"])]))}});export{xe as default};

import{_ as be,s as ge,a as ye,b as he,c as we,d as ke,e as Ce,f as $e,g as Ue}from"./index808565.js";import{a as Se,b as De,A as Ae}from"./LazyDataTable80856.js";import{d as O,o,e as S,r as x,y as K,z as me,w as m,A as Te,c as d,a as e,t as u,f as a,C as I,D as pe,x as ve,E as Ve,F as H,G as Be,q as E,H as Le,u as f,I as Ne,p as Q,n as ze,k as _,J as Pe,K as je,v as J,T as Me,b as Re}from"../index80856.js";import{u as W}from"./user80856.js";import{_ as Ee}from"./MediaTable.vue_vue_type_style_index_0_lang80856.js";import{s as Ie}from"./index80856.js";import{s as Fe}from"./index808563.js";import{s as qe}from"./WarningTable.vue_vue_type_script_setup_true_lang80856.js";import{f as Ge}from"./date80856.js";import{u as He}from"./settings80856.js";import{b as Je,c as Ke,p as Oe,a as Qe}from"./role80856.js";import"./index808566.js";import"./index808564.js";import"./index808567.js";import"./index808568.js";import"./index808562.js";import"./media80856.js";const We=O({__name:"MediaDataTab",props:{user_id:{},video_id:{}},setup(F){return(c,v)=>(o(),S(Ee,{user_id:c.user_id,video_id:c.video_id},null,8,["user_id","video_id"]))}}),Xe={key:0,class:"flex flex-col items-center p-8 bg-surface-0 dark:bg-surface-900 rounded-sm"},Ye={class:"font-bold text-2xl block mb-2 mt-6"},Ze={class:"mb-0"},et={class:"flex flex-col mb-8 mt-4"},tt={class:"flex flex-col mb-8"},st={class:"flex items-center gap-2 mt-6"},lt=O({__name:"ChangeStatusAndRoleDialog",setup(F){const c=W(),v=x([{name:"Utente",code:"user"},{name:"Admin",code:"admin"}]),p=x([{name:"Attivo",code:!0},{name:"Bloccato",code:!1}]),y=x(),t=x(),n=K(()=>c.currentUser);async function C(){try{const i={...n.value};i.role=t.value.code,await c.updateUser(i.id+"",i),pe("Utente aggiornato con successo")}catch(i){console.error(i)}}async function h(){var i,l;try{y.value.code?await c.enableUser(((i=n==null?void 0:n.value)==null?void 0:i.id)+""):await c.disableUser(((l=n==null?void 0:n.value)==null?void 0:l.id)+"")}catch(b){console.error(b)}}return me(n,i=>{i&&(y.value=p.value.find(l=>l.code===i.active),t.value=v.value.find(l=>l.code===i.role))},{immediate:!0}),(i,l)=>{const b=Se,D=ve,$=Te;return o(),S($,{group:"change-status"},{container:m(({message:g,acceptCallback:s,rejectCallback:w})=>[n.value?(o(),d("div",Xe,[l[4]||(l[4]=e("div",{class:"rounded-full text-primary-contrast inline-flex justify-center items-center"},[e("i",{class:"pi pi-user text-4xl!"})],-1)),e("span",Ye,u(g.header),1),e("p",Ze,u(g.message),1),e("div",et,[l[2]||(l[2]=e("label",{for:"notifications_type",class:"text-muted-color font-500 mb-1"},"Cambia stato",-1)),a(b,{modelValue:y.value,"onUpdate:modelValue":l[0]||(l[0]=r=>y.value=r),options:p.value,optionLabel:"name",class:"w-full md:w-60"},null,8,["modelValue","options"])]),e("div",tt,[l[3]||(l[3]=e("label",{for:"notifications_type",class:"text-muted-color font-500 mb-1"},"Cambia ruolo",-1)),a(b,{modelValue:t.value,"onUpdate:modelValue":l[1]||(l[1]=r=>t.value=r),options:v.value,optionLabel:"name",class:"w-full md:w-60"},null,8,["modelValue","options"])]),e("div",st,[a(D,{label:"Annulla",outlined:"",onClick:w,class:"w-32"},null,8,["onClick"]),a(D,{label:"Procedi",onClick:r=>{C(),h(),s()},class:"w-32"},null,8,["onClick"])])])):I("",!0)]),_:1})}}}),at={class:"flex items-center gap-2 w-full"},ot={class:"uppercase font-semibold sm:text-xl mb-2 min-h-[24px]"},it={class:"flex justify-end w-full"},nt={class:"flex items-baseline"},rt={class:"flex flex-row-reverse sm:flex-col justify-center sm:justify-start"},ut={class:"grid grid-cols-none sm:grid-cols-[auto_1fr] p-6 pt-0"},ct={class:"flex items-center flex-col"},dt={class:"relative"},mt={class:"flex flex-col"},pt={class:"sm:pl-6"},vt={class:"pt-4 md:pt-0 text-center md:text-left uppercase font-semibold text-xl mb-2 min-h-[24px]"},ft={class:"flex flex-wrap justify-between"},_t={class:"flex flex-col sm:flex-row gap-1 sm:gap-7 align-center"},xt={class:"flex items-center"},bt={class:"flex items-center"},gt={class:"flex items-center"},yt={class:"flex gap-4 align-center"},ht={class:"flex items-center gap-1"},wt={class:"flex items-center gap-1"},kt={class:"flex items-center gap-1"},Ct={class:"flex flex-col sm:flex-row gap-1 sm:gap-7 align-center pt-4"},$t={class:"flex flex-col mb-2"},Ut={class:"flex flex-col mb-2"},St={class:"flex flex-col mb-2"},Dt={key:0},At={class:"flex flex-col"},Tt={key:0},Vt={class:"flex pt-4 flex-wrap"},Bt={class:"flex flex-col flex-wrap"},Lt={class:"text-wrap max-w-[400px] sm:max-w-none"},Nt={class:"dialog-header"},zt={key:0},Pt=O({__name:"UserDataCard",setup(F){const c=W(),v=He(),p=x(),y=x([{items:[{label:"Cambia stato / ruolo",command:()=>{$()}},{label:"Elimina utente",command:()=>{D()}}]}]),t=K(()=>c.currentUser),n=x(!1),C=x(!1),h=x(!1),i=Ve();async function l(g){try{await c.deleteUser(g),pe("Utente eliminato con successo"),await je.push({name:J.utenti})}catch(s){console.error(s)}}function b(g){n.value=g,g?setTimeout(()=>{C.value=!0},500):C.value=!1}function D(){qe({message:"Stai per eliminare l'utente. Vuoi confermare l'operazione?",header:"Eliminazione utente",acceptCallback(){t.value&&l(t.value.id)}})}function $(){i.require({message:"",header:"Aggiorna utente",group:"change-status",accept:()=>{},reject:()=>{}})}return(g,s)=>{const w=Fe,r=De,X=ve,fe=Pe,_e=Ie,xe=Be,q=Me;return o(),d(H,null,[a(_e,{class:"mt-4",toggleable:"",collapsed:n.value,"onUpdate:collapsed":b},{header:m(()=>{var k,A,T,V,B,L,N,z,P,j,M;return[E(e("div",at,[(k=t.value)!=null&&k.profile_picture_url?(o(),S(w,{key:0,image:(A=t.value)==null?void 0:A.profile_picture_url,shape:"circle"},null,8,["image"])):(o(),S(w,{key:1,label:(((V=(T=t.value)==null?void 0:T.first_name)==null?void 0:V.charAt(0))||"")+(((L=(B=t.value)==null?void 0:B.last_name)==null?void 0:L.charAt(0))||""),class:"mr-2",size:"width: 28px",shape:"circle"},null,8,["label"])),e("p",ot,u((N=t.value)==null?void 0:N.full_name),1)],512),[[Le,n.value&&C.value]]),e("div",it,[e("div",nt,[a(r,{value:f(Je)(((z=t.value)==null?void 0:z.active)+""),severity:f(Ke)(((P=t.value)==null?void 0:P.active)+""),class:"mr-2"},null,8,["value","severity"]),a(r,{value:f(Oe)((j=t.value)==null?void 0:j.role),severity:f(Qe)(((M=t.value)==null?void 0:M.role)+""),rounded:""},null,8,["value","severity"]),a(X,{icon:"pi pi-cog",severity:"secondary",rounded:"",text:"",onClick:s[0]||(s[0]=G=>f(Ne)(p.value,G))}),a(fe,{ref_key:"menu",ref:p,id:"config_menu",model:y.value,popup:""},null,8,["model"])])])]}),default:m(()=>{var k,A,T,V,B,L,N,z,P,j,M,G,Y,Z,ee,te,se,le,ae,oe,ie,ne,re,ue,ce,de;return[e("div",rt,[e("div",ut,[e("div",ct,[e("div",dt,[(k=t.value)!=null&&k.profile_picture_url?(o(),S(w,{key:0,image:(A=t.value)==null?void 0:A.profile_picture_url,class:"mr-2 w-32! h-32! mb-3",shape:"circle"},null,8,["image"])):(o(),S(w,{key:1,label:(((V=(T=t.value)==null?void 0:T.first_name)==null?void 0:V.charAt(0))||"")+(((L=(B=t.value)==null?void 0:B.last_name)==null?void 0:L.charAt(0))||""),class:"mr-2 w-32! h-32! mb-3 text-2xl!",shape:"circle"},null,8,["label"])),(N=t.value)!=null&&N.profile_video_url?E((o(),d("div",{key:2,class:"bg-primary video-profile absolute",onClick:s[1]||(s[1]=U=>h.value=!0)},s[4]||(s[4]=[e("i",{class:"pi pi-youtube text-white"},null,-1)]))),[[q,"Guarda video del profilo",void 0,{top:!0}]]):I("",!0)]),e("div",mt,[(o(!0),d(H,null,Q((z=t.value)==null?void 0:z.categories,(U,R)=>(o(),S(r,{value:f(v).getPrettyCategory(U),class:ze([f(v).getColorCategory(U),"flex items-center mr-2 mb-2 flex-1"]),key:R,rounded:""},null,8,["value","class"]))),128))])]),e("div",pt,[e("div",null,[e("h1",vt,u((P=t.value)==null?void 0:P.first_name)+" "+u((j=t.value)==null?void 0:j.last_name),1)]),e("div",ft,[e("div",_t,[e("div",xt,[s[5]||(s[5]=e("i",{class:"pi pi-user mr-2 text-xs! text-muted-color"},null,-1)),_(" "+u(((M=t.value)==null?void 0:M.username)||"-"),1)]),e("div",bt,[s[6]||(s[6]=e("i",{class:"pi pi-envelope mr-2 text-xs! text-muted-color"},null,-1)),_(" "+u((G=t.value)==null?void 0:G.email),1)]),e("div",gt,[s[7]||(s[7]=e("i",{class:"pi pi-phone mr-2 text-xs! text-muted-color"},null,-1)),_(" "+u(((Y=t.value)==null?void 0:Y.phone_number)||"-"),1)])]),e("div",yt,[E((o(),d("div",ht,[s[8]||(s[8]=e("i",{class:"pi pi-heart-fill text-pink-500 mr-1"},null,-1)),_(" "+u(((Z=t.value)==null?void 0:Z.likes_given_counter)||0),1)])),[[q,"Like ricevuti",void 0,{top:!0}]]),E((o(),d("div",wt,[s[9]||(s[9]=e("i",{class:"pi pi-thumbs-up text-blue-500 mr-1"},null,-1)),_(" "+u(((ee=t.value)==null?void 0:ee.likes_received_counter)||0),1)])),[[q,"Like lasciati",void 0,{top:!0}]]),E((o(),d("div",kt,[s[10]||(s[10]=e("i",{class:"pi pi-video text-purple-500 mr-1"},null,-1)),_(" "+u(((te=t.value)==null?void 0:te.uploaded_video_counter)||0),1)])),[[q,"Video caricati",void 0,{top:!0}]])])]),s[16]||(s[16]=e("hr",{class:"mt-2"},null,-1)),e("div",Ct,[e("div",$t,[s[11]||(s[11]=e("p",{class:"uppercase text-muted-color font-medium mb-4 text-xs"}," cittÃ  ",-1)),_(" "+u(((le=(se=t.value)==null?void 0:se.city)==null?void 0:le.name)||"-"),1)]),e("div",Ut,[s[12]||(s[12]=e("p",{class:"uppercase text-muted-color font-medium mb-4 text-xs"}," data di nascita ",-1)),_(" "+u(f(Ge)((ae=t.value)==null?void 0:ae.birthdate)||"-"),1)]),e("div",St,[s[13]||(s[13]=e("p",{class:"uppercase text-muted-color font-medium !mb-0 text-xs"}," lingue ",-1)),(o(!0),d(H,null,Q((oe=t.value)==null?void 0:oe.languages,(U,R)=>(o(),d("div",{key:R},u(f(v).getPrettyLanguage(U)),1))),128)),!((ie=t.value)!=null&&ie.availability)||((ne=t.value)==null?void 0:ne.availability.length)==0?(o(),d("span",Dt,"-")):I("",!0)]),e("div",At,[s[14]||(s[14]=e("p",{class:"uppercase text-muted-color font-medium !mb-0 text-xs"}," servizi offerti ",-1)),(o(!0),d(H,null,Q((re=t.value)==null?void 0:re.availability,(U,R)=>(o(),d("span",{key:R},u(f(v).getPrettyAvailability(U)),1))),128)),!((ue=t.value)!=null&&ue.availability)||((ce=t.value)==null?void 0:ce.availability.length)==0?(o(),d("span",Tt,"-")):I("",!0)])]),e("div",Vt,[e("div",Bt,[s[15]||(s[15]=e("p",{class:"uppercase text-muted-color font-medium text-xs mb-0!"}," biografia ",-1)),e("div",Lt,u(((de=t.value)==null?void 0:de.bio)||"-"),1)])])])])])]}),_:1},8,["collapsed"]),a(lt),a(xe,{visible:h.value,"onUpdate:visible":s[3]||(s[3]=k=>h.value=k),header:"",style:{width:"25rem"},closable:!1},{header:m(()=>[e("div",Nt,[e("span",{class:"p-dialog-header-close p-link",onClick:s[2]||(s[2]=k=>h.value=!1)},[a(X,{icon:"pi pi-times",variant:"text",rounded:"","aria-label":"Filter",severity:"secondary"})])])]),default:m(()=>[t.value?(o(),d("div",zt,[a(f(be),{type:"default",previewImageLink:t.value.profile_video_img_preview_url,link:t.value.profile_video_url,progress:30,isMuted:!1,isControls:!0},null,8,["previewImageLink","link"])])):I("",!0)]),_:1},8,["visible"])],64)}}}),es=O({__name:"UserDetail",props:{id:{}},setup(F){const c=F,v=W(),p=x([]),y=x(!1),t=K(()=>!c.id),n=K(()=>v.currentUser);function C(){p.value=[{label:"Tutti gli utenti",route:{name:J.utenti}}],t.value?p.value.push({label:"Nuovo utente",route:{name:J.utentiNew}}):p.value.push({label:"Dettagli utente",route:{name:J.utentiDettaglio,params:{id:c.id}}})}me(()=>n.value,i=>{i&&(p.value[p.value.length-1].label=i.full_name)});async function h(i){try{y.value=!0;const l=new Map;await v.fetchUserDetail(i,l)}catch(l){console.error(l)}finally{y.value=!1}}return Re(()=>{C(),c.id&&h(c.id)}),(i,l)=>{const b=we,D=ke,$=Ce,g=$e,s=Ue,w=ge;return o(),d("div",null,[a(Ae,{items:p.value},null,8,["items"]),a(Pt),a(w,{class:"mt-4"},{content:m(()=>[a(s,{scrollable:"",value:"0"},{default:m(()=>[a(D,null,{default:m(()=>[a(b,{value:"0"},{default:m(()=>l[0]||(l[0]=[_("Segnalazioni")])),_:1}),a(b,{value:"1"},{default:m(()=>l[1]||(l[1]=[_("Media")])),_:1}),a(b,{value:"2"},{default:m(()=>l[2]||(l[2]=[_("Commenti")])),_:1})]),_:1}),a(g,null,{default:m(()=>[a($,{value:"0"},{default:m(()=>{var r;return[a(ye,{user_id:(r=n.value)==null?void 0:r.id},null,8,["user_id"])]}),_:1}),a($,{value:"1"},{default:m(()=>{var r;return[a(We,{user_id:(r=n.value)==null?void 0:r.id},null,8,["user_id"])]}),_:1}),a($,{value:"2"},{default:m(()=>{var r;return[a(he,{user_id:(r=n.value)==null?void 0:r.id},null,8,["user_id"])]}),_:1})]),_:1})]),_:1})]),_:1})])}}});export{es as default};
